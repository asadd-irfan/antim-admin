
  <div class="row" >
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
              <div class=" col-lg-12 row welcome-card inner align-items-center ">
                  <div class="w3-xlarge  col-lg-2 p-0" style="text-align: center;">  <button class="back-btn btn-sm" (click)="goBack()" ><i class="fa fa-chevron-left" ></i> Back</button> </div>
                                     
              
                  <div class="col-lg-6 mt-2 padding"><h3 class="m-0">Request Details</h3>
                  </div>
                
                </div>
          </div>
          <div class="card-body">
            <form  *ngIf="requestType == 'Ongoing Requests'" >
              <div class="col-lg-10 row antim-form p-3 mb-5 m-auto" *ngIf="!hideStatusForm">
                <div class="col-lg-12" style="text-align: center;">
                  <h3>Change Product Status</h3>
                  </div>
                  
                   <div class="row" style="width: 100%;"> 
                      <div class="col-lg-6">
                        <select class="form-control form-control-lg mb-2 custom-select" (change)="onChange($event.target.value)">
                          <option value="" selected>Select Product Status</option>
                          <option value="Purchased">Purchased </option>
                          <option value="Delivered">Delivered </option>
                          <option value="Recieved">Recieved </option>
                      </select>
                    
                      </div>
                      <div class="col-lg-4"></div>
                      <div class="col-lg-2">
                        <button class="btn btn-round btn-primary " [disabled]="!savebutton" (click)="changeStatus()">Save</button>
                      </div>
                    </div>
              </div>
             
              </form>
              <form class="col-lg-10 row antim-form p-3 mb-5 m-auto" >
                  <div class="row w-100 " *ngIf="showApproveRejectButtons">
                  <div class="col-lg-8" ></div>
                      <div class="col-lg-2 d-flex justify-content-end mb-3" >
                          <button class="btn  btn-Green "  (click)="OpenApprovePopup(content1)">Approve </button>
                      </div>
                      <div class="col-lg-2 mb-3" >
                          <button class="btn btn-Red "  (click)="OpenRejectPopup(content2)">Reject </button>
                      </div>
                      </div>
               
                      
                  <div class="row" style="width: 100%;">
                    <div class="col-lg-9">
                        <label  class="font-bold mt-2">Request Name: </label>
                        <input  class="form-control  " value="{{requestDetails?.name}}"  placeholder="Request Name"  readonly >
                    </div>
                    <div class="col-lg-3">
                      <label  class="font-bold mt-2">Request Number: </label>
                      <input  class="form-control " value="{{requestDetails?.requestNumber}}" readonly   >
                  </div>
                  </div>
    
                  <div class="row" style="width: 100%;" *ngFor="let product of productList; let i = index;" >
                      <div class="form-group text-left col-lg-9"   >
                          <label  class="font-bold mt-2">Product Link</label>
                          <input  class="form-control  " placeholder="Enter product link here â€¦"   readonly value="{{product.productUrl}}" readonly>
                      </div>
                      <div class="form-group text-left col-lg-3"   >
                          <label  class="font-bold mt-2">Product Price:</label>
                          <input  class="form-control  " placeholder="Enter price here..."    readonly value="{{product.amount}}" readonly>
                        </div>
                    </div>
    
                  <div class="row" style="width: 100%;">
                      <div class="col-lg-4">
                        <label class="font-bold mt-2">Request Date</label>
                        <input  class="form-control  " value="{{requestDate}}" placeholder="Request Date" readonly  >
                    </div>
                    <div class="col-lg-4">
                        <label class="font-bold mt-2">Total price</label>
                        <input  class="form-control  " value="{{requestDetails?.totalFundAmount}}"   placeholder="Amount of funding"    readonly>
                    </div>
                    <div class="col-lg-4">
                      <label  class="font-bold mt-2">Total Payable Amount</label>
                      <input class="form-control  " value="{{requestDetails?.totalPaybackAmount}}"   placeholder="Installment amount per month"   readonly>
                  </div>
                </div>
    
                 <div class="row" style="width: 100%;">
                 <div class="col-lg-4" >
                    <label  class="font-bold mt-2">Installment Period</label>
                    <input class="form-control  " value="{{installmentPeriod}}" placeholder="Installment Period"  readonly>
                </div>
                    <div class="col-lg-4">
                        <label  class="font-bold mt-2">Monthly Installment</label>
                        <input  class="form-control  " value="{{requestDetails?.monthlyPaybackAmount}}"   readonly placeholder="Installment amount per month"  >
                    </div>
                    <div class="col-lg-4" *ngIf="isdeliveryFees">
                      <label  class="font-bold mt-2">Delivery Fees</label>
                      <input  class="form-control" value="{{requestDetails?.delieveryFees}}"   readonly placeholder="Delivery Fees">
                  </div>
                </div>
                <div class="row" style="width: 100%;">
                  <div class="col-lg-6" >
                     <label  class="font-bold mt-2">Antim Total Profit</label>
                     <input class="form-control  " value="{{antimProfit}}"   readonly>
                 </div>
     
                     <div class="col-lg-6">
                         <label  class="font-bold mt-2">Funder Total Profit</label>
                         <input  class="form-control  " value="{{funderProfit}}"   readonly >
                     </div>
                 </div>

                <div class="row" style="width: 100%;">
                    <div class="col-lg-6">
                      <label  class="font-bold mt-2">Request Status</label>
                      <input  class="form-control   " value="{{requestType}}" [(ngModel)]="requestType" [ngModelOptions]="{standalone: true}" readonly  >
                    </div>  
                    <div class="col-lg-6" *ngIf="requestType == 'Ongoing Requests'">
                      <label  class="font-bold mt-2">Product Status</label>
                      <input  class="form-control   " value="{{status}}" [(ngModel)]="status" [ngModelOptions]="{standalone: true}" readonly  >
                    </div>  
               </div>
              
    
                    <div class="col-lg-12 row justify-content-end mt-5 p-0" *ngIf="showRequestDetailsTable">
                      <div class="row my-3 justify-content-center" style="width: 100%;" *ngIf="showTable">
                          <h3  class="font-bold">Installment Details</h3>
                       </div>
                          
                        <table mat-table [dataSource]="dataSource"  class="mat-elevation-z8 mb-5"  cellpadding="20" *ngIf="showTable" >
  
                            <ng-container matColumnDef="months">
                                <th mat-header-cell *matHeaderCellDef >No. </th>
                                <td mat-cell *matCellDef="let element"> {{element.month}} </td>
                              </ng-container>
                              <ng-container matColumnDef="dueDate">
                                        <th mat-header-cell *matHeaderCellDef >Due Date </th>
                                        <td mat-cell *matCellDef="let element"> {{element.date}} </td>
                                      </ng-container>
                                    
                                      <ng-container matColumnDef="price">
                                        <th mat-header-cell *matHeaderCellDef > Monthly Installment </th>
                                        <td mat-cell *matCellDef="let element"> {{element.price}} </td>
                                      </ng-container>

                                      <ng-container matColumnDef="status">
                                        <th mat-header-cell *matHeaderCellDef >Status</th>
                                        <td mat-cell *matCellDef="let element" class="mat-cell {{element.status}}"> {{element.status}} </td>
                                      </ng-container>
                                    
                                     
                                      <ng-container matColumnDef="action">
                                        <th mat-header-cell *matHeaderCellDef style="text-align: center;"> Actions </th>
                                    
                                        <td mat-cell *matCellDef="let row" (click)="$event.stopPropagation()">
                                            <button  type="button" class="btn btn-primary" [disabled]="row.status == 'Paid'" (click)="OpenPayInstallmentPopUp(content3, row)"> Pay </button>
  
                                        </td>
                                      </ng-container>
                                    
                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                      <tr mat-row *matRowDef="let row; columns: displayedColumns;"
                                         >
                                      </tr>
                                    </table>
                                    
                
                  <div class="row my-3 justify-content-center" style="width: 100%;" *ngIf="showTable">
                    <h3  class="font-bold">Request Complete Details</h3>
                  </div>
                 <div class="table-responsive" *ngIf="showTable">
                  <table class="table">
                    <thead class=" text-primary">
                      <tr>
                        <th class="th-style">Date & Time</th>
                        <th class="th-style">Payment Type</th>
                        <th class="th-style">Description</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let data of PaymentDetails">
                        <td style="border: 2px solid black; ">
                          {{data.date}} at  {{data.time}}
                        </td>
                        <td style="border: 2px solid black;">
                          {{data.paymentType}}
                        </td>
                        <td style="border: 2px solid black;">
                          {{data.description}}
                        </td>
                      </tr>
                    </tbody>
                </table>
              </div>
                  </div>
                   
              <ngx-spinner bdColor = "rgba(51, 51, 51, 0.8)"size = "medium"
              color = "white" type = "ball-clip-rotate" [fullScreen] = "true">
              <p style="color: white; margin-top:50px;font-size: 26px;" > Loading... </p>
              </ngx-spinner>
                    </form>

                    <ng-template #content3 let-modal>
                      <div class="modal-header">
                          <h4 class="modal-title p-1 m-1"> Do you really Want To Pay this Installement?
                          </h4>
                          <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-footer">
                        <div class="col-lg-4"></div>
                        <div class="col-lg-4"><button class="btn btn-success btn-lg" (click)="payInstallment()">Yes</button></div>
                        <div class="col-lg-4"><button class="btn btn-danger btn-lg" (click)="modal.close('Close click')">No</button></div>
                        </div>
                    </ng-template>

                    <ng-template #content1 let-modal>
                        <div class="modal-header">
                            <h4 class="modal-title p-1 m-1">    Do you really Want To Approve this Request?
                            </h4>
                            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </div>
                          <div class="modal-footer">
                          <div class="col-lg-4"></div>
                          <div class="col-lg-4"><button class="btn btn-success btn-lg" (click)="approveRequest()">Yes</button></div>
                          <div class="col-lg-4"><button class="btn btn-danger btn-lg" (click)="modal.close('Close click')">No</button></div>

                          </div>
                      </ng-template>
                      <ng-template #content2 let-modal>
                          <div class="modal-header">
                              <h4 class="modal-title p-1 m-1">Do you really Want To Reject this Request?</h4>
                              <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                                    <div class="form-group">
                                      <div class="input-group">
                                        <textarea rows="7" cols="100" placeholder="Enter Reason here..." [(ngModel)]="rejectedReason"></textarea>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="modal-footer">
                                    <div class="col-lg-4"></div>
                                    <div class="col-lg-4"><button class="btn btn-success btn-lg" (click)="rejectRequest()">Yes</button></div>
                                    <div class="col-lg-4"><button class="btn btn-danger btn-lg " (click)="modal.close('Close click')">No</button></div>
                            </div>
                        </ng-template>
                           <ngx-spinner bdColor = "rgba(51, 51, 51, 0.8)"size = "medium"
                color = "white" type = "ball-clip-rotate" [fullScreen] = "true">
                <p style="color: white; margin-top:50px;font-size: 26px;" > Loading... </p>
            </ngx-spinner>
            </div>
      </div>
     
    </div>
    